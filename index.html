<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Loan Amortization Calculator</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <h2>Loan and Amortization Calculator</h2>
    <form id="loanForm">
      <!-- Created table -->
      <table>
        <!-- Table Header -->
        <tr>
          <th>Borrowing Year</th>
          <th>Loan Amount</th>
        </tr>
        <tr>
          <!-- Added the setBorrowingYear function that sets all the borrowing years after setting the first one-->
          <td>
            <input type="number" id="borrowingYear1" required onchange="setBorrowingYear()" />
          </td>
          <td><input type="number" id="loanAmt1" step="0.01" required /></td>
        </tr>
        <tr>
          <!-- Changed to readonly so user can't type -->
          <td><input type="number" id="borrowingYear2" required readonly /></td>
          <td><input type="number" id="loanAmt2" step="0.01" required /></td>
        </tr>
        <tr>
          <!-- Changed to readonly so user can't type -->
          <td><input type="number" id="borrowingYear3" required readonly /></td>
          <td><input type="number" id="loanAmt3" step="0.01" required /></td>
        </tr>
        <tr>
          <!-- Changed to readonly so user can't type -->
          <td><input type="number" id="borrowingYear4" required readonly /></td>
          <td><input type="number" id="loanAmt4" step="0.01" required /></td>
        </tr>
      </table>
      <button type="button" onclick="calculateDebt()">Calculate</button>
    </form>
    <h3>Results</h3>
    <p id="totalDebt">Total Debt:</p>
    <p id="amortization">Annual Amortization Payments:</p>
    <!-- Created the results table -->
    <table>
      <tr>
        <!-- Table Header -->
        <th>Year</th>
        <th>Payment</th>
        <th>Interest</th>
        <th>Principal</th>
        <th>Remaining Debt</th>
      </tr>
      <tr>
        <td id="year1"></td>
        <td id="payment1"></td>
        <td id="interest1"></td>
        <td id="principal1"></td>
        <td id="remaining_debt1"></td>
      </tr>
      <tr>
        <td id="year2"></td>
        <td id="payment2"></td>
        <td id="interest2"></td>
        <td id="principal2"></td>
        <td id="remaining_debt2"></td>
      </tr>
      <tr>
        <td id="year3"></td>
        <td id="payment3"></td>
        <td id="interest3"></td>
        <td id="principal3"></td>
        <td id="remaining_debt3"></td>
      </tr>
      <tr>
        <td id="year4"></td>
        <td id="payment4"></td>
        <td id="interest4"></td>
        <td id="principal4"></td>
        <td id="remaining_debt4"></td>
      </tr>
      <tr>
        <td id="year5"></td>
        <td id="payment5"></td>
        <td id="interest5"></td>
        <td id="principal5"></td>
        <td id="remaining_debt5"></td>
      </tr>
      <tr>
        <td id="year6"></td>
        <td id="payment6"></td>
        <td id="interest6"></td>
        <td id="principal6"></td>
        <td id="remaining_debt6"></td>
      </tr>
      <tr>
        <td id="year7"></td>
        <td id="payment7"></td>
        <td id="interest7"></td>
        <td id="principal7"></td>
        <td id="remaining_debt7"></td>
      </tr>
      <tr>
        <td id="year8"></td>
        <td id="payment8"></td>
        <td id="interest8"></td>
        <td id="principal8"></td>
        <td id="remaining_debt8"></td>
      </tr>
      <tr>
        <td id="year9"></td>
        <td id="payment9"></td>
        <td id="interest9"></td>
        <td id="principal9"></td>
        <td id="remaining_debt9"></td>
      </tr>
      <tr>
        <td id="year10"></td>
        <td id="payment10"></td>
        <td id="interest10"></td>
        <td id="principal10"></td>
        <td id="remaining_debt10"></td>
      </tr>
    </table>
    <script>
      function calculateDebt() {
        //Create the borrowing years and loan amounts variables based on the inputs
        const borrowingYear1 = parseInt(document.getElementById("borrowingYear1").value);
        const loanAmt1 = parseFloat(document.getElementById("loanAmt1").value);
        const borrowingYear2 = parseInt(document.getElementById("borrowingYear2").value);
        const loanAmt2 = parseFloat(document.getElementById("loanAmt2").value);
        const borrowingYear3 = parseInt(document.getElementById("borrowingYear3").value);
        const loanAmt3 = parseFloat(document.getElementById("loanAmt3").value);
        const borrowingYear4 = parseInt(document.getElementById("borrowingYear4").value);
        const loanAmt4 = parseFloat(document.getElementById("loanAmt4").value);
        //Declare the interest rate
        const interestRate = 0.05; // 5% interest
        //Calculate how many years there are between the first and the last year
        const yearsBetween1and4 = borrowingYear4 - borrowingYear1;

        let totalDebt =
          //First loan amount increased by the interest rate for all 4 years
          loanAmt1 * Math.pow(1 + interestRate, yearsBetween1and4) +
          //Second loan amount increased by the interest rate for 3 years
          loanAmt2 * Math.pow(1 + interestRate, yearsBetween1and4 - 1) +
          //Thir loan amount increased by the interest rate for 2 years
          loanAmt3 * Math.pow(1 + interestRate, yearsBetween1and4 - 2) +
          // Last loan has no interest yet
          loanAmt4;

        //Set the repayment years
        const repaymentYears = 10;
        //Calculate the amortization
        const amortization = (totalDebt * interestRate) / (1 - Math.pow(1 + interestRate, -repaymentYears));

        //Set the total debt and amortization values to their respective fields
        document.getElementById("totalDebt").textContent = `Total Debt: $${totalDebt.toFixed(2)}`;
        document.getElementById("amortization").textContent = `Annual Amortization Payments: $${amortization.toFixed(2)}`;

        //Created new "remainingDebt" variable so I didn't alter the totalDebt directly
        let remainingDebt = totalDebt;

        //For loop that will calculate and display the values on the results table
        for (let i = 1; i <= repaymentYears; i++) {
          //Setting dynamic ids for each iteration so it alters the correct html element
          const yearId = "year" + i;
          const paymentId = "payment" + i;
          const interestId = "interest" + i;
          const principalId = "principal" + i;
          const remainingDebtId = "remaining_debt" + i;

          //Calculates the interest
          const interest = remainingDebt * interestRate;
          //Calculates the principal
          const principal = amortization - interest;
          //Sets payment as the amortization value
          const payment = amortization;
          // Update remainingDebt for the next year
          remainingDebt -= principal;

          // Round and display values
          document.getElementById(yearId).textContent = "Year " + i;
          document.getElementById(paymentId).textContent = payment.toFixed(2);
          document.getElementById(interestId).textContent = "$ " + interest.toFixed(2);
          document.getElementById(principalId).textContent = "$ " + principal.toFixed(2);
          document.getElementById(remainingDebtId).textContent = "$ " + Math.max(remainingDebt, 0).toFixed(2); // Ensure no negative values
        }
      }
      //Function that sets the borrowing year automatically
      function setBorrowingYear() {
        //Value of borrowingYear2 is the value of borrowingYear1 + 1
        document.getElementById("borrowingYear2").value = parseInt(document.getElementById("borrowingYear1").value) + 1;
        //Value of borrowingYear3 is the value of borrowingYear1 + 2
        document.getElementById("borrowingYear3").value = parseInt(document.getElementById("borrowingYear1").value) + 2;
        //Value of borrowingYear4 is the value of borrowingYear1 + 3
        document.getElementById("borrowingYear4").value = parseInt(document.getElementById("borrowingYear1").value) + 3;
      }
    </script>
  </body>
</html>
